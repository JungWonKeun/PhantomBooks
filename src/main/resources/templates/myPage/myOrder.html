<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>주문 내역 | Phantom Books</title>
    <link rel="stylesheet" th:href="@{/css/myPage/myPageCommon.css}">
    <link rel="stylesheet" th:href="@{/css/myPage/myOrder.css}">
</head>
<body>
    <header th:replace="~{common/common}"></header>

    <main>
        <section class="content-box">
            <div th:replace="~{myPage/sidebar :: sidebar}"></div>

            <h2>주문 내역</h2>
            <div class="order-container">
                <div th:each="order : ${orders}" class="order-item">
                    <a th:href="@{/orders/{id}(id=${order.id})}" class="order-link">
                        <div class="order-header">
                            <span th:text="${#temporals.format(order.orderDate, 'yyyy-MM-dd')}">주문일자</span>
                            <span th:text="'주문번호: ' + ${order.orderNumber}">주문번호</span>
                        </div>
                        <div class="order-details">
                            <div th:each="item : ${order.items}" class="order-book">
                                <img th:src="${item.book.coverImage}" alt="책 표지">
                                <div class="book-info">
                                    <h3 th:text="${item.book.title}">책 제목</h3>
                                    <p th:text="${item.book.author}">저자</p>
                                    <p th:text="${item.quantity} + '권'">수량</p>
                                    <p th:text="${#numbers.formatDecimal(item.price, 0, 'COMMA', 0, 'POINT')} + '원'">가격</p>
                                </div>
                            </div>
                        </div>
                        <div class="order-footer">
                            <span th:text="'총 결제금액: ' + ${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0, 'POINT')} + '원'">총 금액</span>
                            <button class="btn-review" th:data-order-id="${order.id}">리뷰 작성</button>
                        </div>
                    </a>
                </div>

                <!-- 테스트용 주문 아이템 -->
                <div class="order-item">
                    <div class="order-header">
                        <span>2024-03-20</span>
                        <span>주문번호: TEST-ORDER-001</span>
                    </div>
                    <div class="order-details">
                        <div class="order-book">
                            <img src="https://via.placeholder.com/150x200" alt="책 표지">
                            <div class="book-info">
                                <h3>테스트 책 제목</h3>
                                <p>테스트 저자</p>
                                <p>1권</p>
                                <p>10,000원</p>
                            </div>
                        </div>
                    </div>
                    <div class="order-footer">
                        <span>총 결제금액: 10,000원</span>
                        <button class="btn-review" data-order-id="test">리뷰 작성</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 푸터 -->
    <div th:replace="~{common/footer :: footer}"></div>

    <script src="/js/myPage/myOrder.js"></script>
</body>
</html>
