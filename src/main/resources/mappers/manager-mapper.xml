<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="phantom.books.finalProject.admin.mapper.ManagerMapper">

	<select id="countBookList" resultType ="_int">
		SELECT
			COUNT(*)
		FROM BOOK
	</select>

	<select id="bookList" resultType="Book">
		SELECT
		 BOOK_NO, BOOK_TITLE, BOOK_CONTENT, BOOK_COVER,
		 BOOK_WRITER, COMPANY_NAME, BOOK_TALT, BOOK_PRICE,
		 BOOK_PAGE_COUNT, BOOK_YN, BOOK_DATE, 
		 COUNT(BOOK_NO) AS BOOK_COUNT
		 BASIC_COUNT, 
		FROM BOOK
		LEFT JOIN BOOK_PREFERENCE USING(BOOK_NO)
		LEFT JOIN BOOK_CATEGORY USING(BOOK_NO)
		<choose>
			<when test="sort == 'all'">
				ORDER BY COMPANY_NAME DESC
			</when>
			<when test="sort == 'company'">
				WHERE COMPANY_NAME = #{text}
			</when>
		</choose>
	</select>

</mapper>
